From: Jeff Becker <jeff@i2p.rocks>
Date: Fri, 29 Oct 2021 10:45:02 -0400
Subject: do not requeue nodes for testing from failing queue if we do not
 have them marked as failing anymore

---
 llarp/consensus/reachability_testing.cpp | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/llarp/consensus/reachability_testing.cpp b/llarp/consensus/reachability_testing.cpp
index 99190bc..36281d4 100644
--- a/llarp/consensus/reachability_testing.cpp
+++ b/llarp/consensus/reachability_testing.cpp
@@ -124,7 +124,8 @@ namespace llarp::consensus
       auto& [pk, retest_time, failures] = failing_queue.top();
       if (retest_time > now)
         break;
-      result.emplace_back(pk, failures);
+      if (failing.count(pk))
+        result.emplace_back(pk, failures);
       failing_queue.pop();
     }
     return result;
